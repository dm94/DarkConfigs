<script setup lang="ts">

/**
 * REF: https://github.com/google/blockly-samples/blob/master/examples/blockly-vue3/src/components/BlocklyComponent.vue
 */

import { onMounted, ref, shallowRef } from "vue";
import Blockly from "blockly";

const props = defineProps(["options"]);
const blocklyToolbox = ref();
const blocklyDiv = ref();
const workspace = shallowRef();

defineExpose({ workspace });

onMounted(() => {
    const options = props.options || {};
    if (!options.toolbox) {
        options.toolbox = blocklyToolbox.value;
    }
    workspace.value = Blockly.inject(blocklyDiv.value, options);
});
</script>

<template>
    <div>
        <div class="blocklyDiv" ref="blocklyDiv"></div>
        <xml ref="blocklyToolbox" style="display: none">
            <slot></slot>
        </xml>
    </div>
</template>

<style scoped>
.blocklyDiv {
    height: 100%;
    width: 100%;
    text-align: left;
}
</style>